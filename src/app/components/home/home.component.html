  @if(errorLoading){
 <div class="text-center mt-5  text-danger">
  <i class="fas fa-exclamation-triangle fs-2 mt-5 mb-2"></i>
  <h4>Failed to load products. Please try again later.</h4>
  </div>
}@else {
<section class="products-section py-4">
  <div class="container">
    <!-- Header and Controls -->
    <div class="header-controls">
      <div class="title-section">
        <h2>All Products</h2>
      </div>
      
      <div class="search-sort-section">
        <div>
          <input class="form-control" type="search" placeholder="Search products..." [(ngModel)]="searchTerm">
        </div>
        
         <div class="dropdown">
            <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="sortDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                Sort By
            </button>
            <ul class="dropdown-menu" aria-labelledby="sortDropdown">
                <li><a class="dropdown-item cursor-pointer" (click)="sortProducts('priceAsc')">Price (Low to High)</a></li>
                <li><a class="dropdown-item cursor-pointer" (click)="sortProducts('priceDesc')">Price (High to Low)</a></li>
                <li><a class="dropdown-item cursor-pointer" (click)="sortProducts('nameSort')">Name (A-Z)</a></li>
            </ul>
    </div>
    <div>
        <button class="btn btn-icon btn-dark " (click)="toggleDarkMode()" aria-label="Toggle Dark Mode">
        <i class="fas fa-moon"></i>
        </button>
    </div>
      </div>
    </div>
    @if(filteredProducts().length==0){
      <div class="empty-container text-center py-5">
       <i class="fas fa-search fa-3x mb-3"></i>
      <h4 class="mb-2 text-danger">No products found</h4>
      <p class="text-muted mb-3">Try anthor Words</p>
      </div>
    }
    <!-- Product Grid -->
    <div class="product-grid">
      @for (product of filteredProducts() | paginate: { itemsPerPage: 10, currentPage: currentPage }; track $index) {
      <div class="product-card">
        <div class="card" [routerLink]="['/product/', product.id]">
          <div class="product-image">
            <img [src]="product.image" [alt]="product.title" loading="lazy">
          </div>
          <div class="card-body">
            <span class="category-badge">{{product.category}}</span>
            <h5>{{product.title.split(' ').slice(0,3).join(' ')}}</h5>
            <div class="d-flex justify-content-between align-items-center">
              <span class="fw-bold text-primary">{{product.price | currency:'EGP'}}</span>
              <div>
                <i class="fas fa-star text-warning me-1"></i>
                <span>{{product.rating.rate}}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      }
    </div>
   


    <!-- Pagination -->
    <div class="pagination-container d-flex justify-content-center align-items-center fs-4">
      <pagination-controls 
        (pageChange)="currentPage = $event"
        [directionLinks]="true"
        [autoHide]="false"
        previousLabel="pre"
        nextLabel="next"
        [maxSize]="5" 
        class="pagination-dark">
      </pagination-controls>
    </div>
  </div>
</section>
  }